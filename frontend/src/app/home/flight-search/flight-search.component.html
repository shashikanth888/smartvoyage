
<div class="container parent-container">
    <form [formGroup]="citiesForms" (ngSubmit)="onSubmit()">
        <div class="row">
            <div class="col-md-8 divwithscrollbar">
                    <div class="row">
                        <div class="col-md-8 select2">
                            <span>Source</span>
                            <ngx-select formControlName='source' [items]="airports.city" [(ngModel)]="searchDetails.source" required [ngClass]="{ 'is-invalid': submitted && citiesForms.get('source').errors }" ></ngx-select>
                            <div *ngIf="submitted && citiesForms.get('source').errors?.required" class="invalid-feedback">
                                Source is required
                            </div>
                            
                        </div>
                        <div class="col-xs-12 col-12 col-md-4 form-group select2">
                            <span>Date</span>
                            <input type="date" formControlName='date' placeholder="Date" [(ngModel)]="searchDetails.date" name="date" required class="form-control" [ngClass]="{ 'is-invalid': submitted &&citiesForms.get('date').errors }">
                            <div *ngIf="submitted && citiesForms.get('date').errors?.required" class="invalid-feedback">
                                Date is required
                            </div>
                        </div>
                    </div>
                      <div formArrayName="cityinfo">
                        <ng-container *ngFor="let cityinfo of citiesForms.get('cityinfo').controls; let i=index" [formGroupName]="i" >
                            <div class="row">
                                <div class="col-md-8">
                                    <span>City {{city}}</span>
                                    <ngx-select formControlName="city" [(ngModel)]="searchDetails.cities[i].city" [ngClass]="{ 'is-invalid': submitted && cityinfo.get('city').errors}" [items]="airports.city" required ></ngx-select>
                                    <!--  [(ngModel)]="searchDetails.cities[i].city" -->
                                    <div *ngIf="isValidField(i , 'city')" class="invalid-feedback">
                                        City name is required!
                                     </div>
                                </div>
                                <div class="col-md-3">
                                    <span>Days</span>
                                    <input type="number" formControlName="days" class="form-control"  [(ngModel)]="searchDetails.cities[i].days" [ngClass]="{ 'is-invalid': submitted && cityinfo.get('days').errors }" name="{{'days'+i}}" min="1" placeholder="Number of Days" required>
                                    <!-- [(ngModel)]="searchDetails.cities[i].days" -->
                                    <div *ngIf="isValidField(i , 'days')" class="invalid-feedback">
                                        Days are required!
                                     </div>
                                </div>
                                <div class="col-md-1">
                                    <button type="button" class="close text-centre" id="i" (click)="removeCity(i)" *ngIf="citiesNumber.length > 1" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                      </button>
                                </div>
                            </div>
                        </ng-container>
                      </div>
                    
                    <div class="row">
                        <div class="col-md-8" >
                            <button type="button" class="btn  btn-city" (click)="onAdd()">
                                Add City
                             </button>
                        </div>   
                    </div>
            </div>
            
            <div class="col-md-4 travellers-section">
                <span class="travellers">Travellers</span>
                <div class="row">
                    <div class="dropdown row ts">
                        <div class="col-md-3"><span style="max-width: 100%;">Class</span></div>
                        <div class="col-md-8">
                            <select  class="btn-dropdown form-control" name="singleSelect" [value]='Economy' >
                                <!-- [(ngModel)]="searchDetails.class" -->
                            <option value="Economy" [selected]='true'>Economy</option>
                            <option value="Premium Economy">Premium Economy</option>
                            <option value="Business">Business</option>
                            <option value="First-Class">First-Class</option>
                        </select>
                    </div>
                        
                    </div>
                </div>
                <div class="row">
                    <div class="adult-count row ts">
                        <div class="col-md-4">
                            <span class="adultchild">Adults</span >
                        </div>
                        <div class="col-md-8" > 
                            <div class="incdecdiv">
                                <button  type="button" class="btn btn-incdec" (click)="onDecrementAdult()" [disabled]="adult_count == 1">-</button>
                                <label class="traveller-count" name="adults">{{adult_count}}</label>
                                <button type="button" class="btn btn-incdec" (click)="onIncrementAdult()" [disabled]="adult_count==8">+</button>
                            
                            </div>
                            
                        </div>
                    </div>
                </div>
                <div class="row"> 
                    <div class="children-count row ts">
                        <div class="col-md-4">
                            <span class="adultchild">Children</span>
                        </div>
                        <div class="col-md-8">
                            <div class="incdecdiv">
                                <button  type="button" class="btn btn-incdec" (click)="onDecrementChildren()" [disabled]="children_count == 0">-</button>
                                <label class="traveller-count"  name="children">{{children_count}}</label>
                                <button type="button" class="btn btn-incdec" (click)="onIncrementChildren()" [disabled]="children_count==8">+</button>
                            </div>
                        </div>
                    </div> 
                </div>
                        
            </div>
        </div> 
        <div class="footer flight-footer">
                <button type="submit" class="btn btn-search" >Search</button>
        </div>

    </form>
    
</div>
